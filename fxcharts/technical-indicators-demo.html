<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FXテクニカル指標デモ（ECharts）</title>
  <style>
    :root {
      color-scheme: light;
      font-family: "Noto Sans JP", "Hiragino Kaku Gothic ProN", "Yu Gothic", sans-serif;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: #0f172a;
      color: #e2e8f0;
    }
    header {
      background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%);
      padding: 32px 20px;
      text-align: center;
    }
    header h1 {
      margin: 0 0 12px;
      font-size: 28px;
      letter-spacing: 0.04em;
    }
    header p {
      margin: 0 auto;
      max-width: 760px;
      line-height: 1.7;
      color: rgba(255, 255, 255, 0.85);
      font-size: 14px;
    }
    main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 32px 20px 60px;
    }
    .section {
      margin-bottom: 28px;
      background: #111827;
      border: 1px solid #1f2937;
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 18px 40px rgba(15, 23, 42, 0.45);
    }
    .section h2 {
      margin: 0 0 12px;
      font-size: 20px;
      color: #f8fafc;
    }
    .section p {
      margin: 0 0 12px;
      color: #cbd5f5;
      line-height: 1.7;
      font-size: 14px;
    }
    .chart-grid {
      display: grid;
      gap: 20px;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    }
    .chart-panel {
      background: #0b1220;
      border: 1px solid #1e293b;
      border-radius: 14px;
      padding: 16px;
    }
    .chart-panel h3 {
      margin: 0 0 8px;
      font-size: 16px;
      color: #e2e8f0;
    }
    .chart {
      width: 100%;
      height: 320px;
    }
    .chart.small {
      height: 220px;
    }
    .legend {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 12px;
      font-size: 12px;
      color: #94a3b8;
    }
    .legend span {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      display: inline-block;
    }
    .dot.candle { background: #38bdf8; }
    .dot.ma5 { background: #facc15; }
    .dot.ma20 { background: #a855f7; }
    .dot.rsi { background: #34d399; }
    .dot.macd { background: #f97316; }
    .dot.signal { background: #60a5fa; }
    .note {
      background: rgba(59, 130, 246, 0.1);
      border: 1px solid rgba(59, 130, 246, 0.3);
      padding: 12px 16px;
      border-radius: 12px;
      font-size: 13px;
      color: #bfdbfe;
    }
    footer {
      text-align: center;
      color: #94a3b8;
      font-size: 12px;
      margin-top: 28px;
    }
  </style>
</head>
<body>
  <header>
    <h1>FXチャートの代表的なテクニカル指標</h1>
    <p>
      ECharts の JavaScript ライブラリを使って、ローソク足・移動平均線・RSI・MACD を
      サンプルデータで可視化する方法をまとめたデモ資料です。
    </p>
  </header>

  <main>
    <section class="section">
      <h2>1. ローソク足 & 移動平均線（MA）</h2>
      <p>
        ローソク足は「始値・高値・安値・終値」の4値をまとめて表示します。MA（移動平均線）は
        トレンドの方向感を把握するために利用され、短期（5日）と中期（20日）を重ねることが一般的です。
      </p>
      <div class="chart-panel">
        <h3>サンプル：USD/JPY 12日分</h3>
        <div id="chart-candles" class="chart"></div>
        <div class="legend">
          <span><span class="dot candle"></span>ローソク足</span>
          <span><span class="dot ma5"></span>MA 5</span>
          <span><span class="dot ma20"></span>MA 20</span>
        </div>
      </div>
      <div class="note">
        MAは終値の平均値を計算して折れ線として重ねています。EChartsでは series に line を追加するだけで簡単に重ね描きできます。
      </div>
    </section>

    <section class="section">
      <h2>2. RSI（相対力指数）</h2>
      <p>
        RSI は買われすぎ・売られすぎを判断するオシレーター指標で、70以上で過熱、30以下で売られ過ぎと解釈されます。
      </p>
      <div class="chart-panel">
        <h3>RSI 14（擬似データ）</h3>
        <div id="chart-rsi" class="chart small"></div>
        <div class="legend">
          <span><span class="dot rsi"></span>RSI 14</span>
        </div>
      </div>
    </section>

    <section class="section">
      <h2>3. MACD（移動平均収束拡散）</h2>
      <p>
        MACDは短期EMAと長期EMAの差（MACD線）と、その平均（シグナル）を比較し、トレンドの転換を探ります。
      </p>
      <div class="chart-grid">
        <div class="chart-panel">
          <h3>MACD & シグナル</h3>
          <div id="chart-macd" class="chart small"></div>
          <div class="legend">
            <span><span class="dot macd"></span>MACD</span>
            <span><span class="dot signal"></span>Signal</span>
          </div>
        </div>
        <div class="chart-panel">
          <h3>ヒストグラム</h3>
          <div id="chart-hist" class="chart small"></div>
        </div>
      </div>
    </section>

    <section class="section">
      <h2>4. EChartsでの実装ポイント</h2>
      <ul>
        <li>CDNで <code>echarts.min.js</code> を読み込み、対象DOMに対して <code>echarts.init()</code> で描画。</li>
        <li>ローソク足は <code>candlestick</code> シリーズ、移動平均線は <code>line</code> シリーズで重ねる。</li>
        <li>RSIやMACDは別チャートにし、スクロールや同期を <code>dataZoom</code> で制御すると扱いやすい。</li>
      </ul>
    </section>

    <footer>Sample data © 2026 FX Technical Indicators Demo</footer>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  <script>
    const dates = ['09/02', '09/03', '09/04', '09/05', '09/06', '09/09', '09/10', '09/11', '09/12', '09/13', '09/16', '09/17'];
    const candleData = [
      [147.8, 148.6, 147.4, 148.2],
      [148.2, 149.1, 147.9, 148.9],
      [148.9, 149.4, 148.1, 148.4],
      [148.4, 149.0, 147.6, 147.9],
      [147.9, 148.5, 147.2, 148.1],
      [148.1, 148.8, 147.7, 148.4],
      [148.4, 149.3, 148.0, 149.0],
      [149.0, 149.6, 148.5, 149.2],
      [149.2, 149.9, 148.8, 149.6],
      [149.6, 150.1, 149.0, 149.3],
      [149.3, 149.8, 148.6, 149.0],
      [149.0, 149.5, 148.4, 148.7]
    ];

    const closeValues = candleData.map(item => item[1]);
    const calcMA = (dayCount) => closeValues.map((_, idx) => {
      if (idx < dayCount - 1) return null;
      const slice = closeValues.slice(idx - dayCount + 1, idx + 1);
      const sum = slice.reduce((a, b) => a + b, 0);
      return +(sum / dayCount).toFixed(2);
    });

    const chartCandles = echarts.init(document.getElementById('chart-candles'));
    chartCandles.setOption({
      backgroundColor: 'transparent',
      tooltip: { trigger: 'axis' },
      legend: { show: false },
      xAxis: { type: 'category', data: dates, boundaryGap: true, axisLabel: { color: '#94a3b8' } },
      yAxis: { scale: true, axisLabel: { color: '#94a3b8' } },
      grid: { left: 40, right: 20, bottom: 30, top: 20 },
      series: [
        {
          type: 'candlestick',
          data: candleData,
          itemStyle: {
            color: '#38bdf8',
            color0: '#f87171',
            borderColor: '#38bdf8',
            borderColor0: '#f87171'
          }
        },
        {
          name: 'MA5',
          type: 'line',
          data: calcMA(5),
          smooth: true,
          showSymbol: false,
          lineStyle: { width: 2, color: '#facc15' }
        },
        {
          name: 'MA20',
          type: 'line',
          data: calcMA(10),
          smooth: true,
          showSymbol: false,
          lineStyle: { width: 2, color: '#a855f7' }
        }
      ]
    });

    const rsiValues = [52, 58, 49, 44, 48, 54, 60, 63, 68, 59, 51, 47];
    const chartRsi = echarts.init(document.getElementById('chart-rsi'));
    chartRsi.setOption({
      tooltip: { trigger: 'axis' },
      xAxis: { type: 'category', data: dates, axisLabel: { color: '#94a3b8' } },
      yAxis: { min: 0, max: 100, axisLabel: { color: '#94a3b8' } },
      grid: { left: 40, right: 20, bottom: 30, top: 20 },
      series: [
        {
          name: 'RSI',
          type: 'line',
          data: rsiValues,
          smooth: true,
          lineStyle: { color: '#34d399', width: 2 },
          areaStyle: { color: 'rgba(52, 211, 153, 0.1)' }
        }
      ],
      markLine: {
        symbol: 'none',
        data: [
          { yAxis: 70, lineStyle: { color: '#f87171', type: 'dashed' } },
          { yAxis: 30, lineStyle: { color: '#60a5fa', type: 'dashed' } }
        ]
      }
    });

    const macd = [0.32, 0.45, 0.12, -0.05, 0.08, 0.18, 0.36, 0.41, 0.22, 0.05, -0.08, -0.16];
    const signal = [0.26, 0.33, 0.28, 0.14, 0.12, 0.16, 0.25, 0.32, 0.29, 0.17, 0.05, -0.02];
    const histogram = macd.map((v, i) => +(v - signal[i]).toFixed(2));

    const chartMacd = echarts.init(document.getElementById('chart-macd'));
    chartMacd.setOption({
      tooltip: { trigger: 'axis' },
      xAxis: { type: 'category', data: dates, axisLabel: { color: '#94a3b8' } },
      yAxis: { axisLabel: { color: '#94a3b8' } },
      grid: { left: 40, right: 20, bottom: 30, top: 20 },
      series: [
        {
          name: 'MACD',
          type: 'line',
          data: macd,
          smooth: true,
          lineStyle: { color: '#f97316', width: 2 }
        },
        {
          name: 'Signal',
          type: 'line',
          data: signal,
          smooth: true,
          lineStyle: { color: '#60a5fa', width: 2 }
        }
      ]
    });

    const chartHist = echarts.init(document.getElementById('chart-hist'));
    chartHist.setOption({
      tooltip: { trigger: 'axis' },
      xAxis: { type: 'category', data: dates, axisLabel: { color: '#94a3b8' } },
      yAxis: { axisLabel: { color: '#94a3b8' } },
      grid: { left: 40, right: 20, bottom: 30, top: 20 },
      series: [
        {
          type: 'bar',
          data: histogram,
          itemStyle: {
            color: (params) => params.value >= 0 ? '#38bdf8' : '#f87171'
          }
        }
      ]
    });

    window.addEventListener('resize', () => {
      chartCandles.resize();
      chartRsi.resize();
      chartMacd.resize();
      chartHist.resize();
    });
  </script>
</body>
</html>
